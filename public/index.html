<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pandoc Web Converter</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="stylesheet" href="/style.css" />
  </head>
  <body>
    <main>
      <h1>Pandoc Web Converter</h1>

      <div class="tabs">
        <button class="tab-btn active" data-tab="converter">PDF Converter</button>
        <button class="tab-btn" data-tab="meeting-notes" id="meetingNotesTabBtn" style="display: none;">Meeting Notes</button>
      </div>

      <div id="converter" class="tab-content active">
        <form id="form" action="/convert" method="post" enctype="multipart/form-data">
          <div id="drop" class="drop">
            <h4>Drag & drop .md files here</h4>
            <p>or</p>
            <label for="file" class="file-label">
              Choose files
            </label>
            <input id="file" name="files" type="file" accept=".md,text/markdown" multiple />
            <div id="file-list" class="file-list"></div>
          </div>

          <button id="submit" type="submit" disabled>Convert to PDF</button>

          <h2 class="custom-options-heading">Custom Options</h2>

          <label class="opt">
            Orientation
            <select id="orientation" name="orientation">
              <option value="portrait" selected>Portrait</option>
              <option value="landscape">Landscape</option>
            </select>
          </label>
          <label class="opt">
            Paper Size
            <select id="paperSize" name="paperSize">
              <option value="letter" selected>Letter</option>
              <option value="legal">Legal</option>
              <option value="tabloid">Tabloid</option>
              <option value="a3">A3</option>
              <option value="a4">A4</option>
              <option value="a5">A5</option>
            </select>
          </label>

          <label class="opt">
            <input type="checkbox" id="watermark" name="watermark" />
            Apply watermark (uses watermark.tex)
          </label>
          <label class="opt">
            Watermark text
            <input type="text" id="watermarkText" name="watermarkText" placeholder="DRAFT" disabled />
          </label>

          <details class="filter-section">
            <summary class="filter-summary">Custom Lua Filter</summary>
            <div class="filter-content">
              <label class="opt">
                <input type="checkbox" id="useCustomFilter" />
                Use custom filter
              </label>
              <label class="opt">
                Filter name
                <input type="text" id="filterName" placeholder="custom-filter" />
              </label>
              <div class="opt filter-mode">
                <label>
                  <input type="radio" name="filterMode" value="override" />
                  Override default filter
                </label>
                <label>
                  <input type="radio" name="filterMode" value="additional" checked />
                  In addition to default filter
                </label>
              </div>
              <label class="opt">
                Filter code
                <textarea id="filterCode" class="filter-code" rows="10" placeholder="-- Your Lua filter code here"></textarea>
              </label>
              <button type="button" id="saveFilter" class="button-secondary">Save Filter</button>
              <div id="filterStatus" class="filter-status"></div>
              <div id="savedFilterDisplay" class="saved-filter-display" style="display: none;">
                <h4 id="savedFilterName"></h4>
                <pre id="savedFilterCode" class="saved-filter-code"></pre>
              </div>
            </div>
          </details>
        </form>

        <div id="status" class="status"></div>
        <div id="results" class="results"></div>
      </div>

      <div id="meeting-notes" class="tab-content" style="display: none;">
        <form id="notes-form">
          <div class="form-group">
            <label for="transcript">Transcript (Required)</label>
            <input type="file" id="transcript" name="transcript" accept=".txt,.md,.pdf" required />
            <small>Upload the meeting transcript (text, markdown, or PDF).</small>
          </div>

          <div class="form-group">
            <label>Agenda (Optional)</label>
            <div class="input-mode-group">
              <label><input type="radio" name="agendaMode" value="file" checked> Upload File</label>
              <label><input type="radio" name="agendaMode" value="text"> Paste Text</label>
            </div>
            <div id="agenda-file-input">
              <input type="file" id="agenda" name="agenda" accept=".txt,.md,.pdf" />
              <small>Upload the meeting agenda.</small>
            </div>
            <div id="agenda-text-input" style="display: none;">
              <textarea id="agendaText" name="agendaText" rows="6" placeholder="Paste the agenda text here..."></textarea>
            </div>
          </div>

          <div class="form-group">
            <label for="attendanceText">Attendance (Optional)</label>
            <textarea id="attendanceText" name="attendanceText" rows="4" placeholder="List the attendees here..."></textarea>
            <small>If not explicitly stated in the transcript, list who attended the meeting.</small>
          </div>

          <div class="form-group">
            <label>Past Minutes / Context (Optional)</label>
            <div class="input-mode-group">
              <label><input type="radio" name="contextMode" value="file" checked> Upload File</label>
              <label><input type="radio" name="contextMode" value="library"> Use Library</label>
            </div>
            <div id="context-file-input">
              <input type="file" id="context" name="context" accept=".txt,.md,.pdf" />
              <small>Upload previous meeting minutes for context.</small>
              <button type="button" class="button-secondary btn-small" id="saveContextToLibBtn">Save to Library</button>
            </div>
            <div id="context-library-input" style="display: none;">
              <select id="contextLibrarySelect" name="contextFile">
                <option value="">-- Select from Library --</option>
              </select>
              <small>Select a file stored in the library.</small>
            </div>
          </div>

          <div class="form-group">
            <label>Template (Optional)</label>
            <div class="input-mode-group">
              <label><input type="radio" name="templateMode" value="file" checked> Upload File</label>
              <label><input type="radio" name="templateMode" value="library"> Use Library</label>
            </div>
            <div id="template-file-input">
              <input type="file" id="template" name="template" accept=".txt,.md,.pdf" />
              <small>Upload a template to guide the format.</small>
              <button type="button" class="button-secondary btn-small" id="saveTemplateToLibBtn">Save to Library</button>
            </div>
            <div id="template-library-input" style="display: none;">
              <select id="templateLibrarySelect" name="templateFile">
                <option value="">-- Select from Library --</option>
              </select>
              <small>Select a file stored in the library.</small>
            </div>
          </div>

          <button id="generateNotesBtn" type="submit">Generate Meeting Notes</button>
        </form>

        <div id="notesStatus" class="status"></div>

        <div id="editor-container" class="editor-container" style="display: none;">
          <div class="editor-pane">
            <h4>Markdown Editor</h4>
            <textarea id="markdown-editor" placeholder="Generated markdown will appear here..."></textarea>
          </div>
          <div class="preview-pane">
            <h4>Live Preview</h4>
            <div id="markdown-preview"></div>
          </div>
        </div>

        <div id="notes-actions" class="notes-actions" style="display: none;">
          <button id="downloadMarkdownBtn" class="button-secondary">Download Markdown</button>
          <button id="convertNotesBtn" class="button">Convert to PDF</button>
        </div>
      </div>

    </main>
    <aside id="history" class="history"></aside>
    <script src="/vendor/marked.min.js"></script>
    <script src="/app.js"></script>
  </body>
  </html>


